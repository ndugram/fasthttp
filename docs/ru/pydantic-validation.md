# Валидация Pydantic

FastHTTP seamlessly интегрируется с Pydantic для обеспечения автоматической проверки типов и валидации данных для API ответов. Это гарантирует безопасность типов и целостность данных при работе с внешними API.

## Что такое валидация Pydantic?

Валидация Pydantic позволяет вам определять модели данных, которые автоматически валидируют и парсят API ответы. Когда вы указываете модель ответа, FastHTTP проверяет данные ответа на соответствие структуре и типам модели.

## Преимущества

- **Безопасность типов**: Автоматическая проверка типов во время выполнения
- **Валидация данных**: Гарантирует соответствие данных ожидаемой структуре
- **Поддержка IDE**: Лучшее автодополнение и подсказки типов в вашей IDE
- **Обработка ошибок**: Четкие сообщения об ошибках валидации при недопустимых данных
- **Документация**: Самодокументируемые контракты API
- **Сериализация**: Автоматическое преобразование JSON и парсинг

## Использование моделей ответов

Добавьте параметр `response_model` к любому декоратору HTTP метода для включения автоматической валидации. Данные ответа будут проверены и возвращены как экземпляр вашей модели Pydantic.

```python
from fasthttp import FastHTTP
from pydantic import BaseModel


class User(BaseModel):
    id: int
    name: str
    email: str


app = FastHTTP()


@app.get(url="https://api.example.com/users/1", response_model=User)
async def get_user(resp) -> User:
    data = resp.json()
    return data
```

## Возможности моделей

### Валидация полей

Используйте `Field` от Pydantic для добавления ограничений и правил валидации к полям вашей модели. Это позволяет принудительно применять бизнес-правила прямо в моделях данных.

### Кастомные валидаторы

Реализуйте кастомную логику валидации с помощью декораторов валидаторов Pydantic. Это дает вам полный контроль над тем, как данные проверяются.

### Вложенные модели

Определяйте сложные структуры данных с вложенными моделями Pydantic. Это полезно для API, возвращающих иерархические данные.

### Приведение типов

Pydantic автоматически преобразует совместимые типы, такие как преобразование строковых чисел в целые числа или парсинг строк дат в объекты datetime.

## Типичные сценарии использования

- **API клиенты**: Типобезопасные клиенты для внешних API
- **Валидация данных**: Гарантия целостности данных от сторонних сервисов
- **Подсказки типов**: Лучшее автодополнение и обнаружение ошибок в IDE
- **Документация**: Четкие определения структур данных
- **Предотвращение ошибок**: Раннее обнаружение проблем с данными в разработке

## Ошибки валидации

При неудачной валидации Pydantic вызывает `ValidationError` с детальной информацией о том, какие поля не прошли проверку и почему. Это помогает быстро выявлять и исправлять проблемы с данными.

## Лучшие практики

1. Определяйте отдельные модели для входных и выходных данных при необходимости
2. Используйте описательные имена полей и добавляйте описания
3. Используйте ограничения Field для бизнес-правил
4. Реализуйте кастомные валидаторы для сложной логики
5. Всегда используйте подсказки типов для лучшей поддержки IDE

---

Для большего количества примеров см. раздел [Примеры](examples.md).
